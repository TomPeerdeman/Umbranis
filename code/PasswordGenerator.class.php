<?php	//Dit bestand kan alleen vanuit de index aangeroepen worden	if(!defined("INDEX"))die("NO INDEX!");	class PasswordGenerator{		private $alphabet;			public function __construct(){			$algos = hash_algos();			if(!in_array("sha256", $algos) || !in_array("ripemd320", $algos) || !in_array("haval160,5", $algos)){				die("<p>Some of the password hashes asre not available!</p>");			}			$this->alphabet = array_merge(range('a', 'z'), range('0', '9'), range('A', 'Z'));		}				public function getPasswordHash($pass, $salt){			$passhash = hash("ripemd320", $pass);			$salthash = hash("haval160,5", $salt);						$passhasharray = str_split($passhash, 4);			for($i = 0; $i < 20; $i++){				$passhasharray[$i] = strrev($passhasharray[$i]);			}						$salthasharray = str_split($salthash, 2);			$salthasharray = array_reverse($salthasharray);						$prehash = "";			for($i = 0; $i < 20; $i++){				$prehash .= $passhasharray[$i];				$prehash .= $salthasharray[$i];			}			return hash("sha512", $prehash);		}			public function getRandomSalt(){			$n = mt_rand(8, 25);			$salt = "";			for($i = 0; $i < $n; $i++){				$salt .= $this->alphabet[mt_rand(0, 61)];			}			return addslashes($salt);		}	}?>